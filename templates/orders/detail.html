{% extends 'base/base.html' %}

{% block title %}Commande #{{ order.id }} - E-Shop{% endblock %}

{% block content %}
<div style="max-width: 900px; margin: 2rem auto;">
    <!-- Back Link -->
    <a href="{% url 'orders:list' %}"
        style="color: #666; font-size: 0.9rem; text-decoration: none; display: inline-block; margin-bottom: 1rem;">
        â† Retour Ã  mes commandes
    </a>

    <!-- Header -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1 style="font-size: 2.5rem; color: var(--primary-color);">Commande #{{ order.id }}</h1>
        <div style="display: flex; gap: 0.75rem;">
            {% if order.payment_status == 'paid' %}
            <span
                style="background: #d4edda; color: #155724; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.9rem; font-weight: 500;">
                ğŸ’³ PayÃ©
            </span>
            {% else %}
            <span
                style="background: #fff3cd; color: #856404; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.9rem; font-weight: 500;">
                â³ Paiement en attente
            </span>
            {% endif %}

            {% if order.status == 'pending' %}
            <span
                style="background: #fff3cd; color: #856404; padding: 0.75rem 1.25rem; border-radius: 20px; font-weight: 500;">
                En attente
            </span>
            {% elif order.status == 'delivered' %}
            <span
                style="background: #d4edda; color: #155724; padding: 0.75rem 1.25rem; border-radius: 20px; font-weight: 500;">
                âœ“ LivrÃ©e
            </span>
            {% elif order.status == 'cancelled' %}
            <span
                style="background: #f8d7da; color: #721c24; padding: 0.75rem 1.25rem; border-radius: 20px; font-weight: 500;">
                âœ— AnnulÃ©e
            </span>
            {% else %}
            <span
                style="background: #cce5ff; color: #004085; padding: 0.75rem 1.25rem; border-radius: 20px; font-weight: 500;">
                {{ order.get_status_display }}
            </span>
            {% endif %}
        </div>
    </div>

    <!-- Info Cards Grid -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
        <!-- Shipping Info -->
        <div style="background: white; border-radius: 12px; box-shadow: var(--shadow-sm); padding: 1.5rem;">
            <h2 style="font-size: 1.25rem; margin-bottom: 1rem; color: var(--primary-color);">ğŸ“ Adresse de livraison
            </h2>
            <p style="font-weight: 500; margin-bottom: 0.5rem;">{{ order.first_name }} {{ order.last_name }}</p>
            <p style="color: #666; margin-bottom: 0.25rem;">{{ order.address }}</p>
            <p style="color: #666; margin-bottom: 1rem;">{{ order.postal_code }} {{ order.city }}</p>
            <p style="color: #666; font-size: 0.9rem;">ğŸ“§ {{ order.email }}</p>
            <p style="color: #666; font-size: 0.9rem;">ğŸ“ {{ order.phone }}</p>
        </div>

        <!-- Order Info -->
        <div style="background: white; border-radius: 12px; box-shadow: var(--shadow-sm); padding: 1.5rem;">
            <h2 style="font-size: 1.25rem; margin-bottom: 1rem; color: var(--primary-color);">ğŸ“‹ DÃ©tails</h2>
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                <span style="color: #666;">Date de commande</span>
                <span style="font-weight: 500;">{{ order.created_at|date:"d/m/Y Ã  H:i" }}</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                <span style="color: #666;">MÃ©thode de paiement</span>
                <span style="font-weight: 500;">ğŸ’³ Carte bancaire</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                <span style="color: #666;">Nombre d'articles</span>
                <span style="font-weight: 500;">{{ order.items.count }}</span>
            </div>
            <div
                style="display: flex; justify-content: space-between; padding-top: 1rem; border-top: 1px solid #eee; margin-top: 1rem;">
                <span style="font-size: 1.1rem; font-weight: 500;">Total</span>
                <span style="font-size: 1.25rem; font-weight: bold; color: var(--accent-color);">{{ order.total_price }}
                    â‚¬</span>
            </div>
        </div>
    </div>

    <!-- Order Items -->
    <div style="background: white; border-radius: 12px; box-shadow: var(--shadow-sm); overflow: hidden;">
        <div style="padding: 1.5rem; border-bottom: 1px solid #eee;">
            <h2 style="font-size: 1.25rem; color: var(--primary-color); margin: 0;">ğŸ›’ Articles commandÃ©s</h2>
        </div>

        {% for item in order.items.all %}
        <div style="display: flex; align-items: center; padding: 1.5rem; border-bottom: 1px solid #eee; gap: 1.5rem;">
            {% if item.product.image_url %}
            <img src="{{ item.product.image_url }}" alt="{{ item.product.name }}"
                style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">
            {% else %}
            <div
                style="width: 80px; height: 80px; background: #eee; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #aaa;">
                No img
            </div>
            {% endif %}

            <div style="flex-grow: 1;">
                <h4 style="margin-bottom: 0.25rem;">{{ item.product.name }}</h4>
                <p style="color: #666; font-size: 0.9rem;">{{ item.price }} â‚¬ Ã— {{ item.quantity }}</p>
            </div>

            <div style="font-size: 1.25rem; font-weight: bold; color: var(--accent-color);">
                {{ item.get_cost }} â‚¬
            </div>
        </div>
        {% endfor %}

        <!-- Total -->
        <div
            style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; background: #f9f9f9;">
            <span style="font-size: 1.25rem; font-weight: 500;">Total</span>
            <span style="font-size: 1.75rem; font-weight: bold; color: var(--accent-color);">{{ order.total_price }}
                â‚¬</span>
        </div>
    </div>

    <!-- Actions -->
    {% if order.status == 'pending' %}
    <div style="margin-top: 2rem; text-align: right;">
        <a href="{% url 'orders:cancel' order.id %}" class="btn btn-danger" style="padding: 1rem 2rem;"
            onclick="return confirm('ÃŠtes-vous sÃ»r de vouloir annuler cette commande ?')">
            Annuler la commande
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}